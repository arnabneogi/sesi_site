<?php

function prepopulate_group_ref_form_alter(&$form, &$form_state, $form_id) {

    if( $form_id == 'variable_node_form') {
        watchdog(WATCHDOG_DEBUG, 'prepopulate_group_ref_form_alter '.$form);
        
        // if we know dataset, hide the field 
        // (system will copy permissions from dataset on presave)
        if(isset($_GET['dataset']) && is_numeric($_GET['dataset'])) {
            $form['og_group_ref']['#access'] = FALSE;
        }

        //try to hide always group_content_access 
        //(user will use always the default)
        if(isset($form['group_content_access'])) {
            $form['group_content_access']['#access'] = FALSE;
        }
        
        return;
    }
    
    
    
}

/*
function prepopulate_group_ref_node_presave($node) {

    watchdog(WATCHDOG_DEBUG, 'prepopulate_group_ref_node_presave ');
    if($node['type'] == 'variable') {
        
        if(isset($_GET, 'dataset')) {
            $ds = $_GET['dataset'];
            if(!is_numeric($ds)) {
                watchdog(WATCHDOG_ERROR, 'dataset request parameter is not numeric');
                return;            
            }
        } else {
            watchdog(WATCHDOG_ERROR, 'No dataset parameter to create variable');
            return;
        }
        
        $nds = node_load($ds);
        og_g
        
    }
}*/
